window.mkdfToursFront=function(a){"use strict";function c(){"undefined"!=typeof mkdf&&""!=typeof mkdf||k(),"undefined"!=typeof mkdf&&l(),h(),j(),n(),o(),t(),q().fieldsHelper.init(),q().handleSearch.init(),r().fieldsHelper.init(),s()}function d(){p().init()}function e(){h()}function f(){}function g(){return"undefined"!=typeof mkdf}function h(){var b=a(".mkdf-tour-masonry-gallery-holder .mkdf-tour-masonry-gallery");b.length&&b.each(function(){var b=a(this),c=b.find(".mkdf-tour-grid-sizer").width();i(b,c),b.waitForImages(function(){b.isotope({layoutMode:"packery",itemSelector:".mkdf-tour-gallery-item",percentPosition:!0,packery:{gutter:".mkdf-tour-grid-gutter",columnWidth:".mkdf-tour-grid-sizer"}}),b.css("opacity","1")})})}function i(a,b){var c=a.find(".mkdf-default-masonry-item"),d=a.find(".mkdf-large-width-masonry-item"),e=a.find(".mkdf-large-height-masonry-item"),f=a.find(".mkdf-large-width-height-masonry-item");c.css("height",b-26),d.css("height",b-26),e.css("height",Math.round(2*b-26)),f.css("height",Math.round(2*b-26))}function j(){var b=a(".mkdf-tour-item-single-holder"),c=b.find(".mkdf-tour-item-wrapper ul li a");c.on("click",function(){var b=a(this),c=b.attr("href");"#tour-item-gallery-id"===c&&h()})}function k(){var b=a(".mkdf-tour-item-single-holder"),c=b.find(".mkdf-tour-item-wrapper ul li a"),d=b.find(".mkdf-tour-item-section");c.first().addClass("mkdf-active-item"),c.on("click",function(){c.removeClass("mkdf-active-item");var b=a(this),e=b.attr("href");b.addClass("mkdf-active-item"),d.length&&d.each(function(){var b=a(this);b.attr("id")===e?(b.show(),"#tour-item-location-id"===e&&m()):b.hide()})})}function l(){var b=a(".mkdf-tour-item-single-holder"),c=b.find(".mkdf-tour-item-wrapper ul li a");c.on("click",function(){var b=a(this),c=b.attr("href");"#tour-item-location-id"===c&&m()})}function m(){"undefined"!=typeof mkdf&&""!=typeof mkdf&&mkdf.modules.shortcodes.mkdfShowGoogleMap()}function n(){var b=a(".mkdf-tour-reviews-input-wrapper");if(b.length){var c="icon_star_alt",d="icon_star",e=function(b){b.find(".mkdf-tour-reviews-star-holder").mouseenter(function(){a(this).add(a(this).prevAll()).find(".mkdf-tour-reviews-star").removeClass(c).addClass(d),a(this).nextAll().find(".mkdf-tour-reviews-star").removeClass(d).addClass(c)}).click(function(){b.find(".mkdf-tour-reviews-hidden-input").val(a(this).index()+1)}),b.find(".mkdf-tour-reviews-rating-holder").mouseleave(function(){var e=b.find(".mkdf-tour-reviews-hidden-input").val();e=""===e?0:parseInt(e,10),a(this).find(".mkdf-tour-reviews-star-holder").each(function(b){a(this).find(".mkdf-tour-reviews-star").removeClass(b<e?c:d).addClass(b<e?d:c)})}).trigger("mouseleave")};b.each(function(){var b=a(this),c=b.find(".mkdf-tour-reviews-criteria-holder");c.each(function(){e(a(this))})})}}function o(){var b=a(".mkdf-tours-carousel");b.length&&b.each(function(){var b=a(this);b.hasClass("owl-carousel")||b.addClass("owl-carousel"),b.waitForImages(function(){b.animate({opacity:1})}),b.owlCarousel({autoplay:!0,autoplayHoverPause:!0,dots:!1,nav:!0,smartSpeed:400,loop:!0,navText:['<span class="mkdf-prev-icon"><i class="lnr lnr-chevron-left"></i></span>','<span class="mkdf-next-icon"><i class="lnr lnr-chevron-right"></i></span>'],responsive:{0:{items:1},768:{items:2},1025:{items:3}}})})}function p(){var c,b=a(".mkdf-tours-list-holder"),d=function(a){a.animate({opacity:1}),c=a.isotope({percentPosition:!0,itemSelector:".mkdf-tour-list-item-inner",transitionDuration:"0.4s",isInitLayout:!0,hiddenStyle:{opacity:0},visibleStyle:{opacity:1},masonry:{columnWidth:".mkdf-tours-list-grid-sizer"}}),g()&&mkdf.modules.common.mkdfInitParallax()},e=function(b){var c=b.find(".mkdf-tour-list-filter-item");c.on("click",function(d){d.preventDefault(),d.stopPropagation();var e=a(this),f=e.data("type");c.removeClass("mkdf-tour-list-current-filter"),e.addClass("mkdf-tour-list-current-filter"),f="undefined"==typeof f?"*":"."+f,b.find(".mkdf-tours-list-holder-inner").isotope({filter:f})})},f=function(a){var b=a.find(".mkdf-tour-list-filter-item");b.removeClass("mkdf-tour-list-current-filter"),b.eq(0).addClass("mkdf-tour-list-current-filter"),a.find(".mkdf-tours-list-holder-inner").isotope({filter:"*"})},h=function(b){var c=b.find(".mkdf-tours-list-pagination-data"),d=b.find(".mkdf-tours-list-holder-inner"),e=function(b){var d={action:"mkdf_tours_list_ajax_pagination",fields:c.find("input").serialize()};a.ajax({url:mkdfToursAjaxURL,data:d,dataType:"json",type:"POST",success:function(a){a.havePosts&&c.find('[name="next_page"]').val(a.nextPage),g()&&mkdf.modules.common.mkdfInitParallax(),b.call(this,a)}})},h=function(){var c=b.find(".mkdf-tours-load-more-button"),g=b.find(".mkdf-tours-pagination-holder"),h=!1;c.length&&c.on("click",function(i){i.preventDefault(),i.stopPropagation();var j=c.data("loading-label"),k=c.text();c.text(j),f(b),h||(h=!0,e(function(b){if(b.havePosts===!0){c.text(k);var e=a(b.html);d.append(e),d.waitForImages(function(){d.isotope("appended",e).isotope("reloadItems"),s()})}else c.remove(),g.html(b.message);h=!1}))})};h()};return{init:function(){b.length&&"undefined"!=typeof a.fn.isotope&&b.each(function(){d(a(this).find(".mkdf-tours-list-holder-inner")),e(a(this)),h(a(this))})}}}function q(){var b=a(".mkdf-tours-search-main-filters-holder form"),c=function(){var c=function(){var a=b.find(".mkdf-tours-range-input"),c=b.find(".mkdf-tours-price-range-field"),d=b.find('[name="min_price"]'),e=b.find('[name="max_price"]'),f=c.data("min-price"),g=c.data("max-price"),h=c.data("chosen-min-price"),i=c.data("chosen-max-price");a.length&&a.each(function(){var a=this,b=noUiSlider.create(a,{start:[h,i],connect:!0,step:1,range:{min:[f],max:[g]},format:{to:function(a){return Math.floor(a)},from:function(a){return a}}});b.on("update",function(a){var b=a[0],f=a[1],g=c.data("currency-symbol"),h=c.data("currency-symbol-position"),i="left"===h?g+b:b+g,j="left"===h?g+f:b+f;c.val(i+" - "+j),d.val(b),e.val(f)})})},d=function(){var a="undefined"!=typeof mkdfToursSearchData?mkdfToursSearchData.tours:[],a=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,local:a});b.find(".mkdf-tours-keyword-search").typeahead({hint:!0,highlight:!0,minLength:1},{name:"tours",source:a})},e=function(){var a="undefined"!=typeof mkdfToursSearchData?mkdfToursSearchData.destinations:[],a=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,local:a});b.find(".mkdf-tours-destination-search").typeahead({hint:!0,highlight:!0,minLength:1},{name:"destinations",source:a})},f=function(){var b=a(".mkdf-tours-select-placeholder"),c=function(a){var b=a.val();""===b?a.addClass("mkdf-tours-select-default-option"):a.removeClass("mkdf-tours-select-default-option")};b.length&&b.each(function(){var b=a(this);c(a(this)),b.on("change",function(){c(a(this))})})};return{init:function(){c(),d(),e(),f()}}}(),d=function(){var c=function(a){var b="";location.href.match(/\?.*/)&&document.referrer&&(b=location.href.replace(/\?.*/,"")),window.history.replaceState({page:b+"?"+a},"",b+"?"+a)},d=function(b,d,e,f){var g=b.find('input[type="submit"]'),h=a(".mkdf-tours-search-content"),i=a(".mkdf-tours-search-page-holder"),j=!1;d="undefined"==typeof d||d,e="undefined"==typeof e||e,f="undefined"!=typeof f&&f;var k=g.data("searching-label"),l=g.val();if(!j){d&&g.val(k),e&&b.find('[name="page"]').val(1),j=!0,h.addClass("mkdf-tours-searching");var m={action:"tours_search_handle_form_submission"};m.fields=b.serialize(),a.ajax({type:"GET",url:mkdfToursAjaxURL,dataType:"json",data:m,success:function(b){d&&g.val(l),h.removeClass("mkdf-tours-searching"),j=!1,h.find(".mkdf-grid-row").html(b.html),c(b.url),a(".mkdf-tours-search-pagination").remove(),h.append(b.paginationHTML),f&&a("html, body").animate({scrollTop:i.offset().top-80},700),s()}})}},e=function(b){a("body").hasClass("post-type-archive-tour-item")&&b.on("submit",function(a){a.preventDefault(),a.stopPropagation(),d(b)})},f=function(b){var c=a(".mkdf-search-ordering-item"),e=b.find('[name="order_by"]'),f=b.find('[name="order_type"]');c.length&&c.on("click",function(g){g.preventDefault(),g.stopPropagation();var h=a(this);c.removeClass("mkdf-search-ordering-item-active"),h.addClass("mkdf-search-ordering-item-active");var i=h.data("order-by"),j=h.data("order-type");"undefined"!=typeof i&&"undefined"!=typeof j&&(e.val(i),f.val(j)),d(b,!1,!1)})},g=function(b){var c=a(".mkdf-tours-search-view-item"),e=b.find('[name="view_type"]');c.length&&c.on("click",function(f){f.preventDefault(),f.stopPropagation();var g=a(this);c.removeClass("mkdf-tours-search-view-item-active"),g.addClass("mkdf-tours-search-view-item-active");var h=g.data("type");"undefined"!=typeof h&&e.val(h),d(b,!1,!1)})},h=function(b){var c=a(".mkdf-tours-search-pagination"),e=b.find('[name="page"]');c.length&&a(document).on("click",".mkdf-tours-search-pagination li",function(c){c.preventDefault(),c.stopPropagation();var f=a(this),g=f.data("page");"undefined"!=typeof g&&e.val(g),d(b,!0,!1,!0)})};return{init:function(){e(b),f(b),g(b),h(b)}}}();return{fieldsHelper:c,handleSearch:d}}function r(){var b=a(".mkdf-tours-swf-filter-holder.mkdf-tours-swf-filter-horizontal form"),c=function(){var a=function(){var a="undefined"!=typeof mkdfToursSearchData?mkdfToursSearchData.destinations:[],a=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.whitespace,queryTokenizer:Bloodhound.tokenizers.whitespace,local:a});b.find(".mkdf-tours-destination-search").typeahead({hint:!0,highlight:!0,minLength:1},{name:"destinations",source:a})};return{init:function(){a()}}}();return{fieldsHelper:c}}function s(){var b=a(".mkdf-tours-gallery-item");b.length&&b.each(function(){var b=a(this),c=b.find(".mkdf-tours-gallery-item-content-holder"),d=c.find(".mkdf-tours-gallery-item-excerpt"),e=Math.ceil(d.height());c.css("transform","translate3d(0,"+e+"px,0)"),b.mouseenter(function(){c.css("transform","translate3d(0,0,0)")}),b.mouseleave(function(){e=Math.ceil(d.height()),c.css("transform","translate3d(0,"+e+"px,0)")})})}function t(){var b=a(".mkdf-tours-top-reviews-carousel");b.length&&"undefined"!=typeof a.fn.owlCarousel&&b.each(function(){var b=a(this),c=b.find(".mkdf-tours-top-reviews-carousel-item");b.hasClass("owl-carousel")||b.addClass("owl-carousel");var d=!0;c.length<=1&&(d=!1);var e=function(){var c=b.find(".owl-item");c.removeClass("mkdf-slide-fade-in mkdf-slide-fade-out"),c.each(function(){var c=a(this),d=b.find(".owl-stage-outer").offset().left,e=b.find(".owl-stage-outer").outerWidth(),f=c.offset().left,g=c.outerWidth();f>=d&&f+g<=d+e&&(c.removeClass("mkdf-slide-fade-in").addClass("mkdf-slide-fade-out"),c.next().removeClass("mkdf-slide-fade-out").addClass("mkdf-slide-fade-in"),c.prev().removeClass("mkdf-slide-fade-out").addClass("mkdf-slide-fade-in"))})};b.owlCarousel({items:1,loop:d,autoplay:!0,autoplayTimeout:3e3,smartSpeed:500,autoplayHoverPause:!0,nav:!0,dots:!1,mouseDrag:!1,touchDrag:!1,navText:['<span class="mkdf-prev-icon"><span class="lnr lnr-chevron-left"></span></span>','<span class="mkdf-next-icon"><span class="lnr lnr-chevron-right"></span></span>'],onInitialized:function(){b.css("visibility","visible"),b.find(".owl-item").not(".active").addClass("mkdf-slide-fade-out"),b.find(".owl-item").filter(".active").addClass("mkdf-slide-fade-in")},onChange:function(){e()}})})}var b={};return"undefined"!=typeof mkdf&&""==typeof mkdf&&(mkdf.modules.tours=b),b.mkdfOnDocumentReady=c,b.mkdfOnWindowLoad=d,b.mkdfOnWindowResize=e,b.mkdfOnWindowScroll=f,b.mkdfInitTourItemTabs=k,b.mkdfTourTabsMapTrigger=l,b.mkdfTourReviewsInit=n,b.toursList=p,b.tourCarousel=o,b.initTopReviewsCarousel=t,a(document).ready(c),a(window).load(d),a(window).resize(e),a(window).scroll(f),b}(jQuery);